# Module 2 - Clip 3 - Where Should KQL Be Used

## Demo 1 - Azure Data Explorer

1 - 2 minutes


Exploration and Patterns

```python
let min_peak_t=datetime(2016-08-23 15:00);
let max_peak_t=datetime(2016-08-23 15:02);
demo_clustering1
  | where PreciseTimeStamp between(min_peak_t..max_peak_t)
  | evaluate autocluster()
```

Under the count column we see there are 639 rows that are contained in the pattern of eau Region, su7 ScaleUnit, DeploymentId b5d1d4df547d4a04ac15885617edba57, and ServiceHost of e7f60c5d-4944-42b3-922a-92e98a8e7dec. This pattern represents 65.74% of the rows in our data. Likewise, subsequent rows represent additional patterns.

Be aware that some rows might be represented in few (partially overlapping) patterns , and some rows are not represented in any pattern. The goal of autocluster is to transform a big table to a very small list of informative and divergent patterns, thus presenting the user significant multi-dimensional patterns for quick and efficient drill down and further investigation for the root cause.


## Demo 2 - Monitoring Tools

1-2min

As you’re talking about Azure, don’t just have a screenshot; narrate over typing the query StormData sort by…. and then show the results. Or, you mention creating a cluster and exploring it - show it.  Talk about why someone would use Azure Data Explorer while showing them. It doesn’t have to cover all the features of Azure Data Explorer, but again, a highlight reel, etc.
Overall you want people leaving convinced that KQL is a good solution for their data problems and excited to continue on and learn more.

**Switch to the LogAnalytics**

In this next example, we'll look for outliers. We want to get a list of computers who reported a very low amount of free space. This should be abnormal in our organization, and this query will help us to quickly identify these Azure hosted virtual computers and address the issue.

```python
let myComputerList = toscalar( Perf
                             | where CounterName == "Free Megabytes"
                                 and CounterValue < 1000
                                 and TimeGenerated >= ago(1h)
                             | summarize makeset(Computer)
                             );
Perf
| where TimeGenerated >= ago(1h)
    and Computer in (myComputerList)
    and CounterName == "Free Megabytes"
| project Computer 
        , TimeGenerated 
        , CounterName 
        , CounterValue 
| sort by Computer asc  
        , TimeGenerated desc
        , CounterName asc
```

## Demo 3 - Reporting PowerBI

Open PowerBI Desktop App

Click GetData button in toolbar, then pick more

In the Get Data dialog, enter Azure Data Explorer in the search. When it appears, click on it then click Connect.

In the new dialog, enter https://help.kusto.windows.net into the Cluster name.

You can leave the database name, and the other fields blank except: scroll to the bottom and change the data connectivity mode to DirectQuery. Click OK.

Sign in to Azure Data Explorer if you need to, then click Connect.

In the Navigator, go to Samples and expand it, then pick the StormEvents table. Click on Transform Data.

## Formatting Guide

The notes in this file are used during the recording of the course. It is not meant to be a word for word script, but rather the talking points used for recording.

Notes in plain text are to be used during the recording.

**Notes in bold are instructions during recording, not to be spoken.**

_Notes in italic will be used during the video editing processing._

KQL doesn't have a predefined code setting in Markdown. Use python as the closest match for multi-line code samples.

## Author Information

### Author

Robert C. Cain | [@ArcaneCode](https://twitter.com/arcanecode) | arcanecode@gmail.com

### Websites

About Me: [http://arcanecode.me](http://arcanecode.me)

Blog: [http://arcanecode.com](http://arcanecode.com)

Github: [http://arcanerepo.com](http://arcanerepo.com)

LinkedIn: [http://arcanecode.in](http://arcanecode.in)

### Copyright Notice

This document is Copyright (c) 2022 Robert C. Cain. All rights reserved.

The code samples herein is for demonstration purposes. No warranty or guarantee is implied or expressly granted.

This document may not be reproduced in whole or in part without the express written consent of the author and/or Pluralsight. Information within can be used within your own projects.

